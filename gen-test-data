#!/bin/bash
if [ $# != 2 ]; then
  echo "use gen-test-data raw module"
  exit
fi
dst="test/$(echo $2 | sed -e 's/\./\//g').hs"
data=$(sed -e 's/\r//' \
           -e 's/\\/\\\\/g' \
           -e 's/"/\\"/g' \
           -e 's/.*/"&"/' \
           -e '1   s/.*/vals = unlines [&/' \
           -e '1 ! s/.*/                &/' \
           -e '$   s/.*/&]/' \
           -e '$ ! s/.*/&,/' $1)
haskell=$(echo -e -n "module $2 (vals) where\n--autogenerated; do not edit\nvals :: String\n$data")
echo "$haskell" > $dst
